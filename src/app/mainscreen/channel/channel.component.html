<mat-card id="channel" *ngIf="channelFirebaseService.selectedChannel  && userFirebaseService.currentUser.id!='' ">
    <div class='header'>
        <div class="header-title" width="fit-content">
            <div class="header-title-container" (mouseover)="hoverTitle=true" (mouseout)="hoverTitle=false"
                (click)="showEditChannel = true">
                <h2># {{ channelFirebaseService.selectedChannel.channelName }}</h2>
                <div class="header-title-container-icons">
                    <img *ngIf="!hoverTitle" src="assets/img/icons/arrow_down_black.svg" alt="dropdown_black">
                    <img *ngIf="hoverTitle" src="assets/img/icons/arrow_down_blue.svg" alt="dropdown_blue">
                </div>
            </div>
        </div>

        <div class="addMemberContainer">
            <div class="user-avatar-list" tabindex="0" mat-icon-button [matMenuTriggerFor]="menu"
                #menuTrigger="matMenuTrigger" aria-label="Example icon-button with a menu">
                <img class="avatar-img"
                    *ngFor="let user of channelFirebaseService.userOnCurrentChannel | slice:0:3; let i = index"
                    [style.left]="i * -10 + 'px'" [style.z-index]="3 - i" [src]="user.avatar" alt="avatar">

                <span class="amoundOfUsersInChannel">{{channelFirebaseService.userOnCurrentChannel.length}}</span>

            </div>

            <img class="addmembers" (click)="openChannelUserEdit()"
                src="assets/img/icons/addmembers.svg">
        </div>
    </div>
    <app-edit-channel *ngIf="showEditChannel" (closeEvent)="closeEditDialog()"></app-edit-channel>



    <mat-menu #menu="matMenu" (click)="$event.stopPropagation()">
        <div class="menuHeader" (click)="$event.stopPropagation()">
            <h3 class="menuHeaderText">Mitglieder</h3>
            <img class="close" (click)="closeMenus()" src="/assets/img/icons/close.svg">
        </div>

        <div class="menuUsersContainer" (click)="$event.stopPropagation()">
            <div class="menuUsers" (click)="openProfil(user)"
                *ngFor="let user of channelFirebaseService.userOnCurrentChannel">
                <img class="menuUsersImage" src="{{ user.avatar }}">
                <span class="menuUsersName">{{user.fullName}}</span>
            </div>
        </div>

        <div class="addMemberInMenu" (click)="$event.stopPropagation()">
            <img class="addMemberImage" src="assets/img/icons/addmembers.svg">
            <span class="addMemberText" (click)="openAddMemberMenu()">Teilnehmer hinzuf端gen</span>
        </div>

    </mat-menu>


    <div *ngIf="showChannelUserEdit">
        <div class="menuHeader">
            <h3 class="headerText">Leute hinzuf端gen</h3>
            <img class="closeMenu" (click)="closeChannelUserEdit()" src="/assets/img/icons/close.svg">
        </div>
        <span class="channelName">#{{ channelFirebaseService.selectedChannel.channelName }}</span>
        <app-searchbar 
            [setStyle]="'channelOption'" 
            [hasRemoveAccessInput]="false"   
            [types]="'users'" 
            [action]='channelFirebaseService.selectedChannel' 
            (updatedChannelModel)="handleChannelUserUpdate($event)"
            ></app-searchbar>
    </div> 

    <!--
    <mat-menu *ngIf="showChannelUserEdit">
        <div class="menuHeader">
            <h3 class="headerText">Leute hinzuf端gen</h3>
            <img class="closeMenu" (click)="openChannelUserEdit()" src="/assets/img/icons/close.svg">
        </div>
        <span class="channelName">#entwicklerchannel</span>

        <div class="containerOfInput">
            <app-searchbar 
            [setStyle]="'channelOption'" 
            [hasRemoveAccessInput]="false"   
            [types]="'users'" 
            [action]='channelFirebaseService.selectedChannel' 
            (updatedChannelModel)="handleChannelUserUpdate($event)"
            ></app-searchbar>
        </div>
        <button (click)="saveUserChanges()" class="addSelection">Hinzuf端gen</button>
    </mat-menu>
-->

    <div class="chat-container">

        <ng-container *ngIf="channelFirebaseService.selectedChannelMessages.length>0; else emptyChannel">
            <div *ngFor="let message of channelFirebaseService.selectedChannelMessages; let i = index">
                <app-message [message]="message" [messageLocationName]="'channel'"></app-message>
                <ng-template [appIfChanged]="getMessageTime(message)">
                    <app-date-line *ngIf="channelFirebaseService.selectedChannelMessages[i-1]"
                        [messageTime]="getMessageTime(channelFirebaseService.selectedChannelMessages[i-1])"></app-date-line>
                </ng-template>
            </div>

            <app-date-line
                *ngIf="channelFirebaseService.selectedChannelMessages[channelFirebaseService.selectedChannelMessages.length-1]"
                [messageTime]="getMessageTime(channelFirebaseService.selectedChannelMessages[channelFirebaseService.selectedChannelMessages.length-1])">
            </app-date-line>
        </ng-container>

        <ng-template #emptyChannel>
            <!-- add- Profile Link-->
            <div class="channel-display">
                <div class='channel-header'>
                    <h3># {{ channelFirebaseService.selectedChannel.channelName }}</h3>
                </div>
                <div class="channel-text">
                    Das ist der Anfang des Channels <a href="#"># {{ channelFirebaseService.selectedChannel.channelName
                        }}</a>
                </div>
            </div>
        </ng-template>
    </div>

    <app-message-create [path]="messagePath" [currentLocation]="'channel'"></app-message-create>
</mat-card>